# -*- coding: utf-8 -*-
"""Untitled5.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/14RZMHaxoe4n2xMk2TCD_FM9QAHhyQVK4
"""

"""*Imports*"""

!py -m pip install rouge/requirements.txt
!py -m pip install rouge

import pandas as pd

"""*Mount drive*"""

from google.colab import drive
drive.mount('/content/drive')

"""*Get ROUGE scores*"""

df = pd.read_csv("/content/drive/MyDrive/Dissertation/data/predictions.csv")
actuals = df['Summary'].tolist()
preds = df['Prediction'].tolist()

rouge = Rouge()

def get_rouge_score_cust(preds, actuals, rouge_type):
    tot_scores = {'r': 0, 'p': 0, 'f': 0}
    for i, ac in enumerate(actuals):
        scores = rouge.get_scores(preds[i], ac, avg=True)
        for key in scores[rouge_type].keys():
            tot_scores[key] += scores[rouge_type][key]
    for key in tot_scores.keys():
        tot_scores[key] = tot_scores[key]/len(actuals)
    return tot_scores


print("ROUGE 1", get_rouge_score_cust(preds, actuals, 'rouge-1'))
print("ROUGE 2", get_rouge_score_cust(preds, actuals, 'rouge-2'))
print("ROUGE L", get_rouge_score_cust(preds, actuals, 'rouge-l'))
